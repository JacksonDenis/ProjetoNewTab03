{"version":3,"sources":["componentes/Modal.tsx","componentes/Lista.tsx","index.js"],"names":["cards","card_number","cvv","expiry_date","Modal","state","card_index","e","test","key","preventDefault","currentTarget","value","valor","toString","replace","length","id","valueToPay","headerTitle","document","getElementById","payload","destination_user_id","fetch","method","headers","body","JSON","stringify","then","response","json","data","textContent","success","getElementsByClassName","innerHTML","catch","err","this","props","show","className","onClick","onClose","stopPropagation","placeholder","type","onKeyPress","event","formatCurrency","name","map","card","index","slice","finalValue","getElementsByTagName","Number","substring","selectElement","options","selectedIndex","getAttribute","payUser","user_id","focus","createModal","Component","api","Lista","users","modalUsername","componentDidMount","a","obj","setState","user","src","img","alt","username","createLi","ReactDOM","render"],"mappings":"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","file":"static/js/main.f104f6fc.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport '../css/modal.css';\n\n//Definindo interface para os props que a classe vai receber.\ninterface props {\n    'data-name'?: string;\n    user_id: number;\n    show: boolean;\n    onClose: Function,\n}\n\n// Definindo interface para o Payload que vai ser passado no POST para a API\ninterface TransactionPayload {\n    // Card Info\n    card_number: string;\n    cvv: number;\n    expiry_date: string;\n\n    // Destination User ID\n    destination_user_id: number;\n\n    // Value of the Transaction\n    value: number;\n}\n\n//cartões para exibir como pagamento.\nlet cards = [\n    // valid card\n    {\n        card_number: '1111111111111111',\n        cvv: 789,\n        expiry_date: '01/18',\n    },\n    // invalid card\n    {\n        card_number: '4111111111111234',\n        cvv: 123,\n        expiry_date: '01/20',\n    },\n];\n\n//API para fazer a requisição passando as informações de pagamento.\nconst api = `https://run.mocky.io/v3/533cd5d7-63d3-4488-bf8d-4bb8c751c989`;\n\n//Criando classe do componente Modal.\nclass Modal extends Component<props>{\n\n    //Definindo state com card_index -1, pois será usado em um objeto Array onde o número 0, por padrão, pode criar conflitos\n    state = {\n        card_index: -1,\n    }\n\n    //Função para formatar o input do usuário para moeda, mesma função utilizada no projeto solo de HTML, CSS e JavaScript.\n    formatCurrency(e: any) {\n        const letterPattern = /[^0-9]/;\n        if (letterPattern.test(e.key)) {\n            //console.log(e.key)\n            e.preventDefault();\n            return;\n        }\n        if (!e.currentTarget.value) return;\n\n        let valor = e.currentTarget.value.toString();\n        valor = valor.replace(/[\\D]+/g, '');\n        valor = valor.replace(/([0-9]{1})$/g, \",$1\");\n\n        if (valor.length >= 6) {\n            while (/([0-9]{4})[,|.]/g.test(valor)) {\n                valor = valor.replace(/([0-9]{1})$/g, \",$1\");\n                valor = valor.replace(/([0-9]{3})[,|.]/g, \".$1\");\n            }\n        }\n\n        e.currentTarget.value = valor;\n    }\n\n    //Função para requisitar a API passando as informações de pagamento do Usuário.\n    payUser(id: number, valueToPay: number, card_index: number) {\n        //console.log(id, valueToPay, cards[card_index]);\n\n        //Pegando o titulo do Modal e definindo como um elemento paragrafo de HTML (condutas do typescript)\n        let headerTitle = document.getElementById(\"headerTitle\") as HTMLParagraphElement\n\n        //Criando um objeto com base na interface de Payload\n        let payload: TransactionPayload = {\n            card_number: cards[card_index].card_number,\n            cvv: cards[card_index].cvv,\n            expiry_date: cards[card_index].expiry_date,\n            destination_user_id: id,\n            value: valueToPay\n        }\n\n        //Criando requisição para a API e passando o objeto definido anteriormente como corpo da requisição.\n        fetch(api, {\n            method: \"POST\",\n            headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(payload),\n        }).then((response) => {\n            return response.json();\n        }).then((data) => {\n            //O titulo do modal é definido aqui para evitar que o titulo do Modal mude antes do retorno da requisição.\n            headerTitle.textContent = \"Recibo de pagamento\";\n            //Verificando de o pagamento foi efetuado com sucesso.\n            if (data.success) {\n                //Definindo texto se ocorreu tudo certo.\n                document.getElementsByClassName(\"modalBody\")[0].innerHTML = '<p class=\"paymentStatus\">O pagamento foi concluido com sucesso.</p>';\n            } else {\n                //Definindo texto de algo deu errado\n                document.getElementsByClassName(\"modalBody\")[0].innerHTML = '<p class=\"paymentStatus\">O pagamento <strong>não</strong> foi concluido com sucesso.</p>';\n            }\n        }).catch((err) => {\n            //Definindo texto e titulo do modal se houver algum erro.\n            headerTitle.textContent = \"Recibo de pagamento\";\n            document.getElementsByClassName(\"modalBody\")[0].innerHTML = '<p class=\"paymentStatus\">O pagamento <strong>não</strong> foi concluido com sucesso.</p>';\n        });\n    }\n\n    createModal() {\n        //Verificando se é para mostrar o Modal, por default é false;\n        if (!this.props.show) {\n            return null;\n        }\n\n        //console.log(this.state.card_index)\n\n        //Retornando Modal case o show seja definido para True;\n        return (\n            //Definindo div modal e função para fechar o modal quando clicar fora, ressaltas para a função no onclick que chama função definiado no componente Lista.tsx e altera o State do componente Lista.tsx\n            <div className=\"modal\" onClick={() => { this.props.onClose() }}>\n                {/* Criando header do Modal e definindo a função stopPropagation no click para evitar que os filhos herdem função de cliques do pai. */}\n                <div className=\"modalHeader\" onClick={e => e.stopPropagation()}>\n                    {/* Definindo titulo do Header utilizando os props passado pelo componente Lista.tsx*/}\n                    <p id=\"headerTitle\">Pagamento para <span className=\"username\">{this.props[\"data-name\"]}</span></p>\n                    {/* Criando botão para fechar o  modal, utilzando a função definida para mudar o state do component Lista.tsx*/}\n                    <button className=\"closeBtn\" onClick={() => { this.props.onClose() }}>Fechar</button>\n                </div>\n                {/* Criando corpo do Modal e definindo a função stopPropagation no click para evitar que os filhos herdem função de cliques do pai. */}\n                <div className=\"modalBody\" onClick={e => e.stopPropagation()}>\n                    {/* Criando input definindo placeholder e evento onKeyPress para formatar o input do usuário conforme ele digita. */}\n                    <input placeholder=\"R$ 0,00\" type=\"text\" onKeyPress={(event) => { this.formatCurrency(event) }} />\n                    {/* Criando menu de seleção dos cartões. */}\n                    <select name=\"creditCards\" id=\"creditCards\">\n                        {\n                            //Utiliznado o objeto cards para definir as options do select.\n                            cards.map((card, index) => {\n                                return (\n                                    //Definindo um parametro \"data-key\" com o index do objeto e criando texto com os 4 números finais do cartão.\n                                    <option data-key={index} key={index} value={card.card_number}>{`Cartão com final ${card.card_number.slice(card.card_number.length - 4)}`}</option>\n                                )\n                            })\n                        }\n                    </select>\n                    <button onClick={() => {\n                        //Botão de pagar usuário\n                        //filtrando apenas os números do input.\n                        let valueToPay = document.getElementsByTagName('input')[0].value.replace(/[^0-9]/g, \"\");\n                        //console.log(Number(valueToPay.substring(0, valueToPay.length-2) + \".\" + valueToPay.substring(valueToPay.length-2)))\n                        let finalValue;\n                        //Verificando se existe mais que 1 digito no número, para evitar que pague centavos em vez de unidades de reais.\n                        if (valueToPay.length > 1) {\n                            //se for maior que um, adicione \".\" antes dos dois ultimos números para definir os centavos\n                            finalValue = Number(valueToPay.substring(0, valueToPay.length - 2) + \".\" + valueToPay.substring(valueToPay.length - 2));\n                        } else {\n                            //Se não, pague apenas as unidades de reais;\n                            finalValue = Number(valueToPay);\n                        }\n                        //Pegando o elemento select como um HTMLSelectElement (conduta do typescript)\n                        let selectElement = document.getElementById(\"creditCards\") as HTMLSelectElement;\n                        //Pegando qual elemento que está selecionado no menu select e então pegando seu atributo \"data-key\" que contém o index do cartão selecionado na opção.\n                        let card_index = Number(selectElement.options[selectElement.selectedIndex].getAttribute(\"data-key\"));\n                        if (finalValue) {\n                            //Se houver algum número no input, chama a função de pagamento.\n                            this.payUser(this.props.user_id, finalValue, card_index)\n                        } else {\n                            //Se não, foca no campo do input.\n                            document.getElementsByTagName('input')[0].focus();\n                        }\n                    }}>Pagar</button>\n                </div>\n            </div>\n        )\n    }\n\n    render() {\n        return (\n            this.createModal()\n        )\n    }\n}\n\nexport default Modal;","import { Component } from 'react';\nimport '../css/lista.css';\nimport Modal from './Modal';\n\n//Link da API para fazer o GET dos usuários\nconst api = `https://www.mocky.io/v2/5d531c4f2e0000620081ddce`;\n\n//Modelo de interface que a API vai retornar.\ninterface User {\n    id: string;\n    name: string;\n    img: string;\n    username: string;\n}\n\n//Componente lista para gerar a lista com os usuários\nclass Lista extends Component<User>{\n\n     //state para fazer a funcionalidade do modal e da lista.\n    state = {\n        //item para armazenar os usuários que serão retornados da API para então usar funcionalidade de array.\n        users: [],\n        //item para definir se o modal está visivel ou não\n        show: false,\n        //item para definir o nome do usuário que será pago.\n        modalUsername: \"\",\n\n        user_id: 0,\n    }\n\n    //Requisitar API quando a página terminar de carregar.\n    componentDidMount = async () => {\n        //armazenado a resposta da requisição na API.\n        const response = await fetch(api);\n        //definido a interface que deve conter nos dados retornado pela API.\n        const obj: User = await response.json();\n        //Definindo o item \"users\" do state para o objeto retornado pela API;\n        this.setState({ users: obj });\n    }\n\n    //Função para criar a Lista\n    createLi() {\n        //Criando um map no item users do State, passando a interface como modelo.\n        return this.state.users.map((user: User, index) => {\n            //console.log(user.name)\n            return (\n                //Criando li para cada usuário, contendo parametro \"key\", \"id\" e um parametro customizado \"data-name\"\n                <li className=\"user\" key={user.id} id={user.id} data-name={user.name}>\n                    {/* Imagem do usuário */}\n                    <img className=\"userAvatar\" src={user.img} alt=\"\" />\n                    {/* Informações do Usuário */}\n                    <div className=\"userInfo\">\n                        <div>\n                            <p className=\"username\">{user.name}</p>\n                            <p className=\"userID\">ID: {user.id} - Username: {user.username}</p>\n                        </div>\n                        {/* Botão de pagamento */}\n                        <div className=\"payButton\">\n                            <button onClick={() => {\n                                // Definindo visibilidade do modal e informações do usuário no objeto state.\n                                this.setState({ show: true, modalUsername: user.name, user_id: user.id })\n                            }}>Pagar</button>\n                        </div>\n                    </div>\n                </li>\n            )\n        });\n    }\n\n    render() {\n        return (\n            <div>\n                {/* Chamando o Modal passando props para a estrutura dele. Ressalta para o props \"onClose\" que passa uma função para alterar o state DESTE componente em outro componente*/}\n                <Modal user_id={this.state.user_id} data-name={this.state.modalUsername} show={this.state.show} onClose={() => {this.setState({show: false})}}></Modal>\n                <ul>\n                    {/* Chamando função para criar as li. */}\n                    {this.createLi()}\n                </ul>\n            </div>\n        )\n    }\n}\n\n\nexport default Lista;","import ReactDOM from 'react-dom';\nimport Lista from './componentes/Lista';\nimport './css/index.css';\n\nReactDOM.render(\n    <Lista></Lista>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n"],"sourceRoot":""}